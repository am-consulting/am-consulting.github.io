---
knit: (function(inputFile, encoding) {rmarkdown::render(inputFile, encoding = encoding, output_file = paste0('am-consulting.co.jp-',format(Sys.time(),'%Y-%m-%d-%H-%M-%S'),'.html')) })
title: "出入国管理統計 出入(帰)国者数 速報値 月次 2016年6月"
author: "アセット･マネジメント･コンサルティング株式会社 http://am-consulting.co.jp"
output: 
  html_document:
    fig_height: 10
    fig_width: 10
    keep_md: no
---

```{r,warning=F,error=F,message=F,echo=F}
# Reference http://stackoverflow.com/questions/32377291/insert-date-in-filename-while-knitting-document-using-rstudio-knit-button
library(DT)
library(lubridate)
library(googleVis)
```

```{r,warning=F,error=F,message=F,results='hold',echo=F}
timeSeries<-0 # 1 or 0
dataTitle<-"出入国管理統計 出入(帰)国者数 速報値 月次 2016年6月"
dataSource<-"法務省"
notes<-"複数のワードで検索する際は半角スペースで区切ってください"
paste("Data Source:",dataSource)
paste("作成日:",Sys.time())
paste("特記:",notes)
```

```{r,warning=F,error=F,message=F,echo=F}
tmp <-
  read.table(
  "clipboard",
  header = T,
  sep = "\t",
  stringsAsFactor = F,
  na.strings = c("na", "", "-"),
  check.names = F
  )
  tmp <- data.frame(tmp,tmp[,1,drop=F],check.names = F)
  if(timeSeries==0){
    dataSet <- data.frame(ID = seq(1, nrow(tmp)), tmp, check.names = F)
    dataFormat <- 0
  }else{
    dataSet <- tmp
    dataSet[,1] <- as.Date(dataSet[,1])
    dataFormat <- "%Y-%m"
    if (1 < unique(day(dataSet[, 1]))) {
      dataFormat <- "%Y-%m-%d"
    }
  }

  if (dataFormat != 0) {
    dataSet[, 1] <- format(dataSet[, 1], dataFormat)
    dataSetDT <- dataSet
    dataSetDT0<-data.frame(Date=dataSetDT[-1,1],  round(diff(as.matrix(dataSetDT[,-1]))/as.matrix(dataSetDT[-nrow(dataSetDT),-1])*100,2),check.names = F)
  } else{
    dataSetDT <- dataSet
  }

  funDataTable <- function(obj,append="") {
    DT::datatable(
      obj,
      options = list(
        search.regex = T,
        paging = T,
        autoWidth = T,
        info = T,
        lengthChange = T,
        ordering = T,
        searching = T,
        scrollX = T,
        lengthMenu = list(c(25, -1, 10, 1), c("25", "All", "10", 1)),
        orderClasses = T,
        order = list(list(0, "asc"))
        ),
      rownames = F,
      caption = paste(dataTitle, append),
      class = "display compact"
    )
  }
  
  fungvisTable <- function(obj) {
    PopTable <- gvisTable(      obj, 
      options = list(width = 2000, height = "automatic",  page = "enable" ,  pageSize=30)
    )
    plot(PopTable,tag="chart")
  }  
```
<hr>
```{r,warning=F,error=F,message=F,results='asis',echo=F}
appendTitle<-""
#funDataTable(obj = dataSetDT, append = appendTitle)
cat(paste(dataTitle,appendTitle))
fungvisTable(obj = dataSetDT)
```

```{r,warning=F,error=F,message=F,results='asis',echo=F}
if (dataFormat != 0) {
cat("<hr>")  
funDataTable(obj = dataSetDT0, append = "前月比(%)")
}
```