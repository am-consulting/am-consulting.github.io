```{r}
library(quantmod);library(forecast)
options(scipen = 999)
windowsFonts(Meiryo = windowsFont("Meiryo"))
username <- Sys.info()['user']
pathOutput <-
  paste("C:/Users/", username, "/Desktop/R_Data_Write/", sep = "")
setwd(pathOutput)
```

```{r}
# #DOW , #NIKKEI , #FTSE , #10YrBond , #USDJPY , #VIX 
# 1300 * 900
rangeDays <- 60
symbolS <- c('^DJI','Dow Jones Industrial Average',
             '^N225','Nikkei 225',
             '^FTSE','FTSE 100',
             '^TNX','CBOE Interest Rate 10 Year T No',
             'JPY=X','USD/JPY',
             '^VIX','VOLATILITY S&P 500')
par(mfrow=c(3,2),oma=c(3,0,0,0))
maN <- 10
for(iii in seq(1,length(symbolS),by = 2)){
  price <-
    getSymbols(Symbols = symbolS[iii],auto.assign = F)
  pars <- chart_pars()
  pars$mar <- c(2,4,1,3)
  pars$cex <- 1
  dateRange <-
    paste0(range(tail(index(price),rangeDays)),collapse = '::')
  print(chart_Series(x = price,
                     pars = pars,
                     subset = dateRange,
                     name = symbolS[iii+1],
                     TA = if(maN <= nrow(price)){print(add_SMA(n = maN))}))
}
mtext(text = paste0('Red Line:Moving Average(Over ',maN, ' periods)'),side = 1,outer = T,col = 'red')
```

```{r}
# #SP500 , #NASDAQ , #RUSSELL2000 , #DAX , #KOSPI , #HANGSENG
rangeDays <- 60
symbolS <- c('^GSPC','S&P 500',
             '^IXIC','NASDAQ Composite',
             '^RUT','RUSSELL 2000 INDEX',
             '^GDAXI','DAX',
             '^KS11','KOSPI Composite Index',
             '^HSI','HANG SENG INDEX')
par(mfrow=c(3,2),oma=c(3,0,0,0))
maN <- 10
for(iii in seq(1,length(symbolS),by = 2)){
  price <-
    getSymbols(Symbols = symbolS[iii],auto.assign = F)
  pars <- chart_pars()
  pars$mar <- c(2,4,1,3)
  pars$cex <- 1
  dateRange <-
    paste0(range(tail(index(price),rangeDays)),collapse = '::')
  print(chart_Series(x = price,
                     pars = pars,
                     subset = dateRange,
                     name = symbolS[iii+1],
                     TA = if(maN <= nrow(price)){print(add_SMA(n = maN))}))
}
mtext(text = paste0('Red Line:Moving Average(Over ',maN, ' periods)'),side = 1,outer = T,col = 'red')
```
