---
knit: (function(inputFile, encoding) {username<-Sys.info()['user'];fileName<-'defaultPath.csv';pathToFile <-paste0('C:/Users/', username,'/Desktop/pathToCSV/');setwd(pathToFile);buf0<-read.csv(fileName,header = F,skip = 0,stringsAsFactor = F,check.names = F,fileEncoding = 'utf-8');timeStamp<-format(Sys.time(),'%Y%m%d%H%M%S');rmarkdown::render(inputFile, encoding = encoding, output_file = paste0('C:/Users/',username,buf0[2,1],'charts/','am-consulting.co.jp-knowledgeVaultURL.html')) })

output: html_fragment
---
<!-- knowledgeVaultへのリンク-->


<script>
$(document).ready(function() {
  $('#amcc').DataTable( {
    "order": [[ 0, "asc" ]],
    "lengthMenu":[[10, -1],[10, "All"]],
    "searching" :true,
    "paging"    :true,
    "ordering"  :true,
    "info"      :true,
    "scrollX"   :true
  } );
} );
</script>

<style>
table{white-space: nowrap;}
.entry-content table {border: 0px;}
.entry-content table > thead > tr > th, 
.entry-content table > tbody > tr > th, 
.entry-content table > tfoot > tr > th, 
.entry-content table > thead > tr > td, 
.entry-content table > tbody > tr > td, 
.entry-content table > tfoot > tr > td {border-left: none; border-right: none;}
</style>

```{r warning=F,error=F,message=F,echo=F}
library(excel.link)
fileName <-'defaultPath.csv'
username <- Sys.info()['user']
pathToFile <- paste0('C:/Users/', username,'/Desktop/pathToCSV/')
setwd(pathToFile)
buf000 <- read.csv(fileName,header = F,skip = 0,stringsAsFactor = F,check.names = F,fileEncoding = 'utf-8')
pathOutput <- paste0("C:/Users/", username, buf000[2,1],'csv/')
setwd(pathOutput)
fileName <- dir(pathOutput)[grep('knowledgevault',dir(pathOutput),ignore.case = T)]
tmp0 <- read.table(fileName, sep = ',', fileEncoding = 'utf8', header = T)
```

```{r warning=F,error=F,message=F,echo=F}
buf <- tmp0
buf[,grep('title',colnames(buf),ignore.case = T)] <- 
  paste0('<a href="',buf[,grep('url',colnames(buf),ignore.case = T)],
         '" target="_blank">',
         buf[,grep('title',colnames(buf),ignore.case = T)],
         '</a>')
buf <- buf[,-grep('url',colnames(buf),ignore.case = T)]
buf <- data.frame(`No.`=seq(1,nrow(buf)),buf,check.names = F,stringsAsFactors = F)
setwd(pathOutput)
write.csv(x = buf[,c(1,2)], file = "urlList.csv", quote = F, row.names = F, append = F, fileEncoding = 'utf8')
```

***

<!-- table part -->

```{r warning=F,error=F,message=F,echo=F,results='asis'}
knitr::kable(buf, row.names = F, format = "html", 
             table.attr = "id='amcc' class='display compact' width='100%' cellspacing='0'", escape = F, 
             align = c("r", "l", "c"))
```

<!-- table part -->

***

<!-- knowledgeVaultへのリンク-->
