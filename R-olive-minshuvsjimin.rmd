---
knit: (function(inputFile, encoding) {rmarkdown::render(inputFile, encoding = encoding, output_file = paste0('am-consulting.co.jp-',format(Sys.time(),'%Y-%m-%d-%H-%M-%S'),'.html')) })
title: "景気動向指数 2016年5月分"
author: "アセット･マネジメント･コンサルティング株式会社 http://am-consulting.co.jp"
output: 
  html_document:
    fig_height: 8
    fig_width: 10
    keep_md: no
---

```{r,warning=F,error=F,message=F,results='hold',echo=F}
dataTitle<-"景気動向指数 2016年5月分\n第3次産業活動指数(対事業所サービス業)(平成22年=100) , 常用雇用指数(調査産業計)(前年同月比)(%)"
dataSource<-"内閣府"
notes<-"複数のワードで検索する際は半角スペースで区切ってください"
paste("Raw Data Source:",dataSource)
paste("作成日:",Sys.time())
paste("特記:",notes)
```

```{r,warning=F,error=F,message=F,echo=F}
datafreq<-12 # 4 , 12
library(ggplot2)
library(xtable)
library(grid)
library(lubridate)
#library(ggrepel)
#Error: package ‘ggplot2’ 1.0.1 is loaded, but >= 2.0.0 is required by ‘ggrepel’
```

```{r,warning=F,error=F,message=F,echo=F}
tmp <-
  read.table(
  "clipboard",
  header = TRUE,
  sep = "\t",
  stringsAsFactor = F,
  na.strings = c("NA", "-", "－", "… ", ".", ""),
  check.names = FALSE
  )
  tmp[, 1] <- as.Date(tmp[, 1])
```

```{r,warning=F,error=F,message=F,echo=F}
#windowsFonts(Meiryo=windowsFont("Meiryo"))
SD<-Sys.Date();ST<-Sys.time()
#par(mfrow=c(1,1),family="Meiryo",ps=17,oma=c(3,3,3,2),mar=c(5,5,5,5))
dataset<-subset(tmp,as.Date("2009/9/1")<=tmp[,1])
dataset$Number<-seq(1,nrow(dataset))
dataset$color<-ifelse(dataset[,1]<=as.Date("2012/12/1"),"indianred1","royalblue")
if(datafreq==4){datestart<-c(year(dataset[1,1]),month(dataset[1,1])/3)}else{datestart<-c(year(dataset[1,1]),month(dataset[1,1]))}
# http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf
```

```{r,warning=F,error=F,message=F,echo=F}
minPoint<-min(dataset[,2:3])
maxPoint<-max(dataset[,2:3])
funPlot<-function(){
g<-ggplot()
g<-g+geom_point(data=dataset,aes(x=dataset[,2],y=dataset[,3]),color=dataset$color,size=4)
g<-g+ggtitle(paste(dataTitle,"\nSource:",dataSource,"\n赤:民主党 , 青:自民党",sep=""))
g<-g+xlab(colnames(dataset)[2])+ylab(colnames(dataset)[3])
g<-g+theme(plot.title=element_text(family="Meiryo"))
g<-g+theme(axis.title.x=element_text(family="Meiryo")) 
g<-g+theme(axis.title.y=element_text(family="Meiryo")) 
g<-g+theme(axis.text.x=element_text(angle=0,family="Meiryo")) 
g<-g+theme(axis.text.y=element_text(angle=90,family="Meiryo"))
#g<-g+geom_line(aes(x=c(minPoint,maxPoint),y=c(minPoint,maxPoint)),color="black")
g<-g+geom_text(data=dataset,aes(x=dataset[ ,2],y=dataset[ ,3],label=dataset$Number)              ,vjust=0,hjust=2,family="Meiryo")
g<-g+geom_text(data=dataset,aes(x=dataset[1,2],y=dataset[1,3],label=format(dataset[1,1],"%Y-%m")),vjust=1,hjust=0,family="Meiryo")
g<-g+geom_text(data=dataset,aes(x=dataset[nrow(dataset),2],y=dataset[nrow(dataset),3],label=format(dataset[nrow(dataset),1],"%Y-%m")),vjust=0,hjust=0,family="Meiryo")
buf<-subset(dataset,dataset[,1]==as.Date("2012/12/1"))
g<-g+geom_text(data=buf,aes(x=buf[1,2],y=buf[1,3],label=format(as.Date("2012/12/1"),"%Y-%m")),vjust=1,hjust=0,family="Meiryo")
g<-g+geom_path(data=dataset,aes(x=dataset[,2],y=dataset[,3]),color=dataset$color)
print(g)
}
```

```{r,warning=F,error=F,message=F,results='asis',echo=F}
funPlot()
```
<hr>
```{r,warning=F,error=F,message=F,echo=F,results='asis'}
cat(paste("
<script src=\"https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js\"></script>
<style>
table{width:100%;border-collapse:collapse;padding:0;border-spacing:1;margin-left: auto;margin-right: auto;}
tr, td, th{white-space: nowrap;}
table.amcc tr:nth-child(odd) {background-color: #F5F5F5;}
table.amcc tr:nth-child(even){background-color: #FFFFFF;}
</style>
<div align=\"center\">
<b>",dataTitle,"</b>
</div>
<b>",colnames(dataset)[4],"</b>
<div style=\"overflow-x:scroll;\">",sep=""))

print(
  xtable(ts(dataset[,4],frequency=datafreq,start=datestart)),
  type="html",include.rownames=T,html.table.attributes="class='amcc'")

cat(paste("
</div>
<div style=\"text-align:center\">
</div>
<hr>
<b>",colnames(dataset)[2],"</b>
<div style=\"overflow-x:scroll;\">",sep=""))

print(
  xtable(ts(dataset[,2],frequency=datafreq,start=datestart)),
  type="html",include.rownames=T,html.table.attributes="class='amcc'")

cat(paste("
</div>
<hr>
<b>",colnames(dataset)[3],"</b>
<div style=\"overflow-x:scroll;\">",sep=""))

print(
  xtable(ts(dataset[,3],frequency=datafreq,start=datestart)),
type="html",include.rownames=T,html.table.attributes="class='amcc'")

cat(paste("
</div>
<script>
$(\"tr\").not(':first').hover(
function () {$(this).css(\"background\",\"#8FBC8F\");}, 
function () {$(this).css(\"background\",\"\");}
);
</script>",sep=""))
```