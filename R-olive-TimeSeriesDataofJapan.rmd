---
knit: (function(inputFile, encoding) {username<-Sys.info()['user'];fileName<-'defaultPath.csv';pathToFile <-paste0('C:/Users/', username,'/Desktop/pathToCSV/');setwd(pathToFile);buf0<-read.csv(fileName,header = F,skip = 0,stringsAsFactor = F,check.names = F,fileEncoding = 'utf-8');timeStamp<-format(Sys.time(),'%Y%m%d%H%M%S');rmarkdown::render(inputFile, encoding = encoding, output_file = paste0('C:/Users/',username,buf0[2,1],'charts/','am-consulting.co.jp-','suiciderate','.html')) })

title : 'Suicide Rate in Japan'
author: "アセット･マネジメント･コンサルティング株式会社 http://am-consulting.co.jp"
date: "`r format(Sys.time(), '%Y-%m-%d %H:%M:%S')`"
output: 
  html_document:
    fig_height: 6
    fig_width: 10
    keep_md: no
    md_extensions: -ascii_identifiers
---
<link href="http://knowledgevault.saecanet.com/components/rmarkdown-html.css" rel="stylesheet">
<style>
body{font-family:'Hiragino Kaku Gothic Pro','Meiryo UI',Verdana,sans-serif;}
.main-container {
	max-width: 1000px;
	margin-left: auto;
	margin-right: auto;
}
table{
 white-space: nowrap;
}
</style>

- アセット･マネジメント･コンサルティング株式会社 http://am-consulting.co.jp
- SaECaNet http://saecanet.com/
- Olive http://olive.saecanet.com/
- twitter https://twitter.com/AMC2_Japan

本ページへのリンクを共有:<a href="https://twitter.com/share" class="twitter-share-button" data-via="AMC2_Japan" data-size="large">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

```{r set-options, echo=F, cache=F}
options(width = 1000)
```

```{r,warning=F,error=F,message=F,echo=F}
library(dygraphs)
library(xts)
library(lubridate)
```

```{r,warning=F,error=F,message=F,results='hold',echo=F}
dataTitle <- '日本の自殺率:人口10万人当たりの自殺者数'
dataSource <- '厚生労働省、警察庁、総務省'
notes <- '複数のワードで検索する際は半角スペースで区切ってください'
notes0 <- "表中、-9999はNAを意味します"
Author <- "アセット･マネジメント･コンサルティング株式会社 http://am-consulting.co.jp"
cat(paste("Title       : ", dataTitle, "\n"))
cat(paste("Data Source : ", dataSource, "\n"))
cat(paste("Author      : ", Author, "\n"))
cat(paste("特  記      : ", notes, "\n"))
cat(paste("特  記      : ", notes0, "\n"))
windowsFonts(Meiryo = windowsFont("Meiryo"))
options(scipen = 999)
```

- 年次データの日付は××××年12月31日としています。

```{r warning=F,error=F,message=F,echo=F,results='hide'}
tmp0 <-
  read.table('clipboard',header = T,sep = '\t',stringsAsFactor = F,na.strings = c('','NA'),check.names = F,fill = T,quote = "",fileEncoding="cp932")#,fileEncoding="UTF-8")
head(tmp0)
```

```{r warning=F,error=F,message=F,echo=F,results='hide'}
tmp <- tmp0
tmp[,1] <- as.Date(tmp[,1])
tmp[,1] <- as.Date(paste0(year(tmp[,1]),'-12-31'))
head(tmp)
dataSet <- tmp
```

```{r warning=F,error=F,message=F,echo=F}
dyBarChart <- function(dygraph) {
  dyPlotter(dygraph = dygraph,
            name = "BarChart",
            path = system.file("examples/plotters/barchart.js",package = "dygraphs"))
}
dyUnzoom <-function(dygraph) {
  dyPlugin(dygraph = dygraph,
           name = "Unzoom",
           path = system.file("examples/plugins/unzoom.js", package = "dygraphs"))
}
dyCrosshair <- function(dygraph,direction = c("both", "horizontal", "vertical")) {
  dyPlugin(dygraph = dygraph,
           name = "Crosshair",
           path = system.file("examples/plugins/crosshair.js",package = "dygraphs"),
           options = list(direction = match.arg(direction)))
}
dyMultiColumn <- function(dygraph) {
  dyPlotter(dygraph = dygraph,
            name = "MultiColumn",
            path = system.file("examples/plotters/multicolumn.js",package = "dygraphs"))
}
```

```{r warning=F,error=F,message=F,echo=F}
fun_dygraph <- function(obj = dataSet, mainTitle = ""){
  timeSeries0 <- obj
  timeSeries <- xts(timeSeries0[,-1], order.by=timeSeries0[,1])
  colnames(timeSeries) <- colnames(timeSeries0)[-1]
  dygraphPlot <<- 
    dygraph(timeSeries,main = mainTitle,group = 'amcc') %>% 
    dyLegend(width = 300) %>% 
    dyRangeSelector() %>% 
    dyUnzoom() %>% dyCrosshair(direction = "both")
} 
fun_dygraph(obj = dataSet,mainTitle = '')
```

#### 消費税と`r dataTitle`

```{r warning=F,error=F,message=F,echo=F,fig.height=4,fig.width=10}
dygraphPlot %>%
    dyShading(from = "1989-04-01", to = "1997-03-31", color = "#FFE6E6") %>%
    dyShading(from = "1997-04-01", to = "2014-03-31", color = "#CCEBD6") %>%
    dyShading(from = "2014-04-01", to = tail(dataSet[,1],1), color = "#FFE6E6") %>%
    dyEvent("1997-03-31", "消費税3%", labelLoc = "bottom") %>%
    dyEvent("2014-03-31", "消費税5%", labelLoc = "bottom") %>%
    dyEvent(tail(dataSet[,1],1), "消費税8%", labelLoc = "bottom")
```

***
#### 政権と`r dataTitle`

```{r warning=F,error=F,message=F,echo=F}
primeMinisterOfJapan <- c(
  "1885-12-22",    "Hirobumi Ito(1)",
  "1888-4-30" ,    "Kiyotaka Kuroda",
  "1889-10-25",    "Sanetomi Sanjo",
  "1889-12-24",    "Aritomo Yamagata(1)",
  "1891-5-6"  ,    "Masayoshi Matsukata(1)",
  "1892-8-8"  ,    "Hirobumi Ito(2)",
  "1896-9-18" ,    "Masayoshi Matsukata(2)",
  "1898-1-12" ,    "Hirobumi Ito(3)",
  "1898-6-30" ,    "Shigenobu Okuma(1)",
  "1898-11-8" ,    "Aritomo Yamagata(2)",
  "1900-10-19",    "Hirobumi Ito(4)",
  "1901-6-2"  ,    "Taro Katsura(1)",
  "1906-1-7"  ,    "Kinmochi Saionji(1)",
  "1908-7-14" ,    "Taro Katsura(2)",
  "1911-8-30" ,    "Kinmochi Saionji(2)",
  "1912-12-21",    "Taro Katsura(3)",
  "1913-2-20" ,    "Gonnohyoe Yamamoto(1)",
  "1914-4-16" ,    "Shigenobu Okuma(2)",
  "1916-10-9" ,    "Masatake Terauchi",
  "1918-9-29" ,    "Takashi Hara",
  "1921-11-13",    "Korekiyo Takahashi",
  "1922-6-12" ,    "Tomosaburo Kato",
  "1923-9-2"  ,    "Gonnohyoe Yamamoto(2)",
  "1924-1-7"  ,    "Keigo Kiyoura",
  "1924-6-11" ,    "Takaaki Kato",
  "1926-1-30" ,    "Reijiro Wakatsuki(1)",
  "1927-4-20" ,    "Giichi Tanaka",
  "1929-7-2"  ,    "Osachi Hamaguchi",
  "1931-4-14" ,    "Reijiro Wakatsuki(2)",
  "1931-12-13",    "Tsuyoshi Inukai",
  "1932-5-26" ,    "Makoto Saito",
  "1934-7-8"  ,    "Keisuke Okada",
  "1936-3-9"  ,    "Koki Hirota",
  "1937-2-2"  ,    "Senjuro Hayashi",
  "1937-6-4"  ,    "Fumimaro Konoe(1)",
  "1939-1-5"  ,    "Kiichiro Hiranuma",
  "1939-8-30" ,    "Nobuyuki Abe",
  "1940-1-16" ,    "Mitsumasa Yonai",
  "1940-7-22" ,    "Fumimaro Konoe(2-3)",
  "1941-10-18",    "Hideki Tojo",
  "1944-7-22" ,    "Kuniaki Koiso",
  "1945-4-7"  ,    "Kantaro Suzuki",
  "1945-8-17" ,    "Prince Naruhiko Higashikuni",
  "1945-10-9" ,    "Kijuro Shidehara",
  "1946-5-22" ,    "Shigeru Yoshida(1)",
  "1947-5-24" ,    "Tetsu Katayama",
  "1948-3-10" ,    "Hitoshi Ashida",
  "1948-10-15",    "Shigeru Yoshida(2-5)",
  "1954-12-10",    "Ichiro Hatoyama(1-3)",
  "1956-12-23",    "Tanzan Ishibashi",
  "1957-2-25" ,    "Nobusuke Kishi(1-2)",
  "1960-7-19" ,    "Hayato Ikeda(1-3)",
  "1964-11-9" ,    "Eisaku Sato(1-3)",
  "1972-7-7"  ,    "Kakuei Tanaka(1-2)",
  "1974-12-9" ,    "三木武夫",
  "1976-12-24",    "福田赳夫",
  "1978-12-7" ,    "大平正芳(1-2)",
  "1980-7-17" ,    "鈴木善幸",
  "1982-11-27",    "中曽根康弘(1-3)",
  "1987-11-6" ,    "竹下登",
  "1989-6-3"  ,    "宇野宗佑",
  "1989-8-10" ,    "海部俊樹(1-2)",
  "1991-11-5" ,    "宮沢喜一",
  "1993-8-9"  ,    "細川護煕",
  "1994-4-28" ,    "羽田孜",
  "1994-6-30" ,    "村山富市",
  "1996-1-11" ,    "橋本龍太郎(1-2)",
  "1998-7-30" ,    "小渕恵三",
  "2000-4-5"  ,    "森喜朗(1-2)",
  "2001-4-26" ,    "小泉純一郎(1-3)",
  "2006-9-26" ,    "安倍晋三(1)",
  "2007-9-26" ,    "福田康夫",
  "2008-9-24" ,    "麻生太郎",
  "2009-9-16" ,    "鳩山由紀夫",
  "2010-6-8"  ,    "菅直人",
  "2011-9-2"  ,    "野田佳彦",
  "2012-12-26",    "安倍晋三(2,3)"
)
cnt <- 1
pmTable <- data.frame()
for(rrr in seq(1,length(primeMinisterOfJapan),by = 2)){
  pmTable[cnt,1] <- as.character(as.Date(primeMinisterOfJapan[rrr]))  
  pmTable[cnt,2] <- as.character(as.Date(primeMinisterOfJapan[rrr+2]))
  pmTable[cnt,3] <- primeMinisterOfJapan[rrr+1]
  cnt <- cnt +1 
}
pmTable[nrow(pmTable),2] <- as.character(Sys.Date())
write.table(pmTable, "clipboard", sep = "\t", row.names = F, col.names = T)
out <- NULL
for(rrr in 1:nrow(pmTable)){
  if(rrr %% 2 == 0){col <- '#FFE6E6'}else{col <- '#CCEBD6'}
  tmp1 <- paste0('dyShading(from = \'',pmTable[rrr,1],'\', to = \'',pmTable[rrr,2],'\', color = \'',col,'\') %>% ') 
  if(rrr!=nrow(pmTable)){
    tmp2 <- paste0('dyEvent(\'',pmTable[rrr,2],'\',\'',pmTable[rrr,3],'\', labelLoc = \'bottom\') %>% ')
  }else{
    tmp2 <- paste0('dyEvent(\'',dataSet[nrow(dataSet),1],'\',\'',pmTable[rrr,3],'\', labelLoc = \'bottom\')')
  }
  out <- c(out, tmp1, tmp2)
}
buf0 <-paste(out, collapse = '')
```

```{r warning=F,error=F,message=F,echo=F,fig.height=4,fig.width=10}
eval(parse(text = paste0('dygraphPlot %>% ',buf0)))
```

***
#### 日銀総裁と`r dataTitle`

```{r warning=F,error=F,message=F,echo=F,fig.height=4,fig.width=10}
boj <- c(
  "1882-10-6" ,    "Shigetoshi Yoshihara",
  "1888-2-21" ,    "Tetsunosuke Tomita",
  "1889-9-3"  ,    "Koichiro Kawada",
  "1896-11-11",    "Yanosuke Iwasaki",
  "1898-10-20",    "Tatsuo Yamamoto",
  "1903-10-20",    "Shigeyoshi Matsuo",
  "1911-6-1"  ,    "Korekiyo Takahashi",
  "1913-2-28" ,    "Yataro Mishima",
  "1919-3-13" ,    "Junnosuke Inoue(1)",
  "1923-9-5"  ,    "Otohiko Ichiki",
  "1927-5-10" ,    "Junnosuke Inoue(2)",
  "1928-6-12" ,    "Hisaakira Hijikata",
  "1935-6-4"  ,    "Eigo Fukai",
  "1937-2-9"  ,    "Shigeaki Ikeda",
  "1937-7-27" ,    "Toyotaro Yuki",
  "1944-3-18" ,    "Keizo Shibusawa",
  "1945-10-9" ,    "Eikichi Araki(1)",
  "1946-6-1"  ,    "Hisato Ichimada",
  "1954-12-11",    "Eikichi Araki(2)",
  "1956-11-30",    "Masamichi Yamagiwa",
  "1964-12-17",    "Makoto Usami",
  "1969-12-17",    "Tadashi Sasaki",
  "1974-12-17",    "森永貞一郎",
  "1979-12-17",    "前川春夫",
  "1984-12-17",    "澄田智",
  "1989-12-17",    "三重野康",
  "1994-12-17",    "松下康夫",
  "1998-3-20" ,    "速水優",
  "2003-3-20" ,    "福井俊彦",
  "2008-4-9"  ,    "白川正明",
  "2013-3-20" ,    "黒田東彦"
)
cnt <- 1
bojTable <- data.frame()
for(rrr in seq(1,length(boj),by = 2)){
  bojTable[cnt,1] <- as.character(as.Date(boj[rrr]))  
  bojTable[cnt,2] <- as.character(as.Date(boj[rrr+2]))
  bojTable[cnt,3] <- boj[rrr+1]
  cnt <- cnt +1 
}
bojTable[nrow(bojTable),2] <- as.character(Sys.Date())
write.table(bojTable, "clipboard", sep = "\t", row.names = F, col.names = T)
out <- NULL
for(rrr in 1:nrow(bojTable)){
  if(rrr %% 2 == 0){col <- '#FFE6E6'}else{col <- '#CCEBD6'}
  tmp1 <- paste0('dyShading(from = \'',bojTable[rrr,1],'\', to = \'',bojTable[rrr,2],'\', color = \'',col,'\') %>% ') 
  if(rrr!=nrow(bojTable)){
    tmp2 <- paste0('dyEvent(\'',bojTable[rrr,2],'\',\'',bojTable[rrr,3],'\', labelLoc = \'bottom\') %>% ')
  }else{
    tmp2 <- paste0('dyEvent(\'',dataSet[nrow(dataSet),1],'\',\'',bojTable[rrr,3],'\', labelLoc = \'bottom\')')
  }
  out <- c(out, tmp1, tmp2)
}
buf0 <-paste(out, collapse = '')
```

```{r warning=F,error=F,message=F,echo=F,fig.height=4,fig.width=10}
eval(parse(text = paste0('dygraphPlot %>% ',buf0)))
```

***
#### 出来事と`r dataTitle`

```{r warning=F,error=F,message=F,echo=F,}
eventRange <-c(
  "2013-09-08",as.character(dataSet[nrow(dataSet),1]),"2020年東京オリンピック決定",
  "1986-12-01","1991-02-01","バブル景気",
  "1997-01-01","1998-01-01","アジア通貨危機"
)  
event <- c(
  as.character(dataSet[nrow(dataSet),1]),"2020年東京オリンピック決定",
  "1998-01-01","アジア通貨危機",
  "1991-02-01","バブル景気",
  "2008-09-15","リーマン･ブラザーズ破綻",
  "2016-11-08","2016年アメリカ合衆国大統領選挙",
  "2011-03-11","東日本大震災",
  "1995-01-17","阪神･淡路大震災",
  "1985-09-22","プラザ合意",
  "1971-12-18","スミソニアン協定",
  "1990-03-27","総量規制",
  "1987-10-19","ブラックマンデー",
  "1987-02-22","ルーブル合意"
)
event <- iconv(event,'shift_jis','utf8')
cnt <- 1
eventTable <- data.frame()
for(rrr in seq(1,length(event),by = 2)){
  eventTable[cnt,1] <- as.character(as.Date(event[rrr]))  
  eventTable[cnt,2] <- event[rrr+1]
  cnt <- cnt +1 
}
cnt <- 1
eventRangeTable <- data.frame()
for(rrr in seq(1,length(eventRange),by = 3)){
  eventRangeTable[cnt,1] <- as.character(as.Date(eventRange[rrr]))  
  eventRangeTable[cnt,2] <- as.character(as.Date(eventRange[rrr+1]))  
  eventRangeTable[cnt,3] <- eventRange[rrr+2]
  cnt <- cnt +1 
}
out <- NULL
for(rrr in 1:nrow(eventRangeTable)){
  if(rrr %% 2 == 0){col <- '#FFE6E6'}else{col <- '#CCEBD6'}
  tmp <- paste0('dyShading(from = \'',eventRangeTable[rrr,1],'\', to = \'',eventRangeTable[rrr,2],'\', color = \'',col,'\')') 
  out <- c(out, tmp)
}
buf0 <-paste(out, collapse = ' %>% ')
out <- NULL
for(rrr in seq(1,length(event),by=2)){
  if(dataSet[1,1]<= event[rrr]){
    tmp <- paste0('dyEvent(\'',event[rrr],'\',\'',event[rrr+1],'\', labelLoc = \'bottom\')')
    out <- c(out, tmp)
  }
}
buf1 <-paste(out, collapse = ' %>% ')
```

```{r warning=F,error=F,message=F,echo=F,fig.height=4,fig.width=10}
eval(parse(text = paste0('dygraphPlot %>% ',buf0,' %>% ',buf1)))
```

***

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3077339-5', 'auto');
  ga('send', 'pageview');

</script>