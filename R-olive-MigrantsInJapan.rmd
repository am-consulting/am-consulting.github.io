```{r}
library(Nippon)
username <- 
  Sys.info()['user']
pathOutput <- 
  paste0("C:/Users/", username, "/Desktop/R_Data_Write/")
setwd(pathOutput)
sheetNo <- 1
fileList <-
  dir(pathOutput,pattern = '.xls',ignore.case = T,include.dirs = F)
for(iii in seq(length(fileList))){
  buf0 <-
    XLConnect::readWorksheetFromFile(file = paste0(pathOutput, fileList[iii]),
                                     sheet = sheetNo,
                                     check.names = F,
                                     header = F)
  buf0[10,] <-
    gsub('na',NA,sapply(gsub('\\s','',buf0[10,]),zen2han),ignore.case = T)
  buf0[10,] <-
    gsub('^転入者数$',NA,gsub('他都道府県からの','他都道府県からの転入者数',buf0[10,]))
  tmp <- NA
  for(ccc in 1:ncol(buf0)){
    if(!is.na(buf0[10,ccc])){tmp <- buf0[10,ccc]}
    buf0[10,ccc] <- tmp
  }
  colnames(buf0) <-
    paste0(buf0[10,],':',gsub('\\s','',buf0[14,]))
  objCol <-
    which(apply(buf0,2,function(x)length(grep('北海道',x)))!=0)
  objRow <- 
    which(apply(buf0,1,function(x)length(grep('北海道',x)))!=0)
  buf1 <- 
    buf0[objRow:nrow(buf0),objCol:ncol(buf0)]
  colnames(buf1)[1] <- '都道府県'
  buf2 <-
    buf1[,-grep('na',colnames(buf1),ignore.case = T)]
  buf3 <-
    buf2[!is.na(buf2[,1]),]
  buf3[,-1] <- 
    apply(buf3[,-1],2,function(x)as.numeric(gsub(',|\\s','',x)))
  assign(paste0('data',gsub('.xls','',fileList[iii])),
         buf3,
         envir = .GlobalEnv)
}
```
